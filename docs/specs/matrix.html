<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Specification Matrix - AGISystem2</title>
    <link rel="stylesheet" href="../reference/style.css">
    <style>
        .matrix-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        .matrix-section {
            background: white;
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .matrix-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        .matrix-table th,
        .matrix-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
            vertical-align: top;
        }
        .matrix-table th {
            background-color: #f5f5f5;
            font-weight: bold;
        }
        .spec-id {
            background: #e3f2fd;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
            font-size: 0.85em;
            white-space: nowrap;
        }
        .spec-link {
            color: #1976d2;
            text-decoration: none;
        }
        .spec-link:hover {
            text-decoration: underline;
        }

        /* Test status styles */
        .test-status {
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 0.85em;
            display: inline-block;
            min-width: 80px;
            text-align: center;
        }
        .status-passed {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status-failed {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .status-partial {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeeba;
        }
        .status-unknown {
            background: #e2e3e5;
            color: #383d41;
            border: 1px solid #d6d8db;
        }
        .status-skipped {
            background: #cce5ff;
            color: #004085;
            border: 1px solid #b8daff;
        }

        /* Coverage styles */
        .coverage-partial {
            background: #fff3cd;
            color: #856404;
        }
        .coverage-full {
            background: #d4edda;
            color: #155724;
        }
        .coverage-none {
            background: #f8d7da;
            color: #721c24;
        }

        .gamp-category {
            font-weight: bold;
            background: #e8eaf6;
        }
        .back-link {
            margin-bottom: 20px;
        }
        .legend {
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        .legend-item {
            display: inline-block;
            margin: 5px 15px 5px 0;
        }
        .legend-box {
            display: inline-block;
            width: 20px;
            height: 15px;
            margin-right: 5px;
            border: 1px solid #ccc;
            vertical-align: middle;
        }

        /* Test results summary */
        .test-summary {
            margin: 20px 0;
            padding: 15px;
            background: #f0f4f8;
            border-radius: 8px;
            border-left: 4px solid #1976d2;
        }
        .test-summary h4 {
            margin: 0 0 10px 0;
            color: #1976d2;
        }
        .summary-stats {
            display: flex;
            gap: 30px;
            flex-wrap: wrap;
        }
        .stat-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
        }
        .stat-label {
            color: #666;
        }

        /* Loading indicator */
        .loading {
            color: #666;
            font-style: italic;
        }

        /* Timestamp */
        .results-timestamp {
            color: #666;
            font-size: 0.85em;
            margin-top: 10px;
        }

        /* New document highlight */
        .new-doc {
            background: #e8f5e9;
        }
        .new-badge {
            background: #4caf50;
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.7em;
            margin-left: 5px;
            vertical-align: middle;
        }

        /* Consolidation note */
        .consolidation-note {
            background: #fff3cd;
            border: 1px solid #ffeeba;
            border-radius: 5px;
            padding: 15px;
            margin: 20px 0;
        }
        .consolidation-note h4 {
            margin: 0 0 10px 0;
            color: #856404;
        }
    </style>
</head>
<body>
    <div class="page">
        <div class="nav-header">
            <h1>AGISystem2 Specification Matrix</h1>
            <small>
                <a href="../index.html">Home</a> ·
                <a href="../guides/conceptual_spaces.html">Theory</a> ·
                <a href="../architecture/index.html">Architecture</a> ·
                <a href="../api/index.html">APIs</a> ·
                <a href="../syntax/index.html">Syntax</a> ·
                <a href="../usage-cli/index.html">CLI</a> ·
                <a href="../wiki/index.html">Wiki</a> ·
                <a href="matrix.html">Specs</a>
            </small>
            <div class="sub-nav">
                <strong>Specifications:</strong>
                <a href="matrix.html">Traceability Matrix</a> ·
                <a href="../specsLoader.html">Specification Loader</a> ·
                <a href="../specsLoader.html?spec=URS.md">User Requirements</a> ·
                <a href="../specsLoader.html?spec=NFS.md">Non-Functional Requirements</a> ·
                <a href="../specsLoader.html?spec=DS_map.md">Design Specification Map</a>
            </div>
        </div>

        <div class="matrix-container">
            <div class="back-link">
                <a href="../index.html">&larr; Back to Home</a>
            </div>

            <!-- Consolidation Note -->
            <div class="consolidation-note">
                <h4>Requirements Consolidated</h4>
                <p>URS, FS, and NFS have been consolidated to remove duplicates. See cross-reference tables in each spec file for mapping from old to new IDs.</p>
                <ul>
                    <li><strong>URS:</strong> 28 &rarr; 21 requirements</li>
                    <li><strong>FS:</strong> 16 &rarr; 14 requirements</li>
                    <li><strong>NFS:</strong> 28 &rarr; 23 requirements</li>
                </ul>
            </div>

            <!-- Test Results Summary -->
            <div class="test-summary" id="test-summary">
                <h4>Test Results Summary</h4>
                <div class="summary-stats" id="summary-stats">
                    <span class="loading">Loading test results...</span>
                </div>
                <div class="results-timestamp" id="results-timestamp"></div>
            </div>

            <div class="legend">
                <h4>Legend:</h4>
                <div class="legend-item">
                    <span class="legend-box" style="background: #d4edda;"></span>
                    PASSED - All tests passed
                </div>
                <div class="legend-item">
                    <span class="legend-box" style="background: #f8d7da;"></span>
                    FAILED - Tests failed
                </div>
                <div class="legend-item">
                    <span class="legend-box" style="background: #fff3cd;"></span>
                    PARTIAL - Some tests passed
                </div>
                <div class="legend-item">
                    <span class="legend-box" style="background: #e2e3e5;"></span>
                    UNKNOWN - No test data
                </div>
                <div class="legend-item">
                    <span class="legend-box" style="background: #cce5ff;"></span>
                    SKIPPED - Tests skipped
                </div>
                <div class="legend-item">
                    <span class="new-badge">NEW</span>
                    Recently added specification
                </div>
            </div>

            <!-- Requirement Specifications -->
            <div class="matrix-section">
                <h2>Requirement Specifications (URS / FS / NFS)</h2>

                <h3>User Requirements (URS) - Consolidated</h3>
                <table class="matrix-table">
                    <thead>
                        <tr>
                            <th>Requirement (ID + section)</th>
                            <th>Title</th>
                        </tr>
                    </thead>
                    <tbody id="urs-table-body">
                        <!-- Populated by JavaScript -->
                    </tbody>
                </table>

                <h3>Functional Specification (FS) - Consolidated</h3>
                <table class="matrix-table">
                    <thead>
                        <tr>
                            <th>FS (ID + spec)</th>
                            <th>Summary</th>
                        </tr>
                    </thead>
                    <tbody id="fs-table-body">
                        <!-- Populated by JavaScript -->
                    </tbody>
                </table>

                <h3>Non-Functional Specification (NFS) - Consolidated</h3>
                <table class="matrix-table">
                    <thead>
                        <tr>
                            <th>NFS (ID + section)</th>
                            <th>Title</th>
                        </tr>
                    </thead>
                    <tbody id="nfs-table-body">
                        <!-- Populated by JavaScript -->
                    </tbody>
                </table>
            </div>

            <!-- Design Specifications Coverage -->
            <div class="matrix-section">
                <h2>Design Specifications &rarr; Requirements (DS &rarr; URS / FS / NFS)</h2>
                <table class="matrix-table">
                    <thead>
                        <tr>
                            <th>Component (linked spec, DS ID)</th>
                            <th>Requirements Covered (URS / FS / NFS)</th>
                            <th>Coverage</th>
                            <th>Test Status</th>
                        </tr>
                    </thead>
                    <tbody id="ds-table-body">
                        <!-- Populated by JavaScript -->
                    </tbody>
                </table>
            </div>

            <!-- Test Suite Coverage -->
            <div class="matrix-section">
                <h2>Test Suites &rarr; Requirements (Tests &rarr; URS / FS / NFS)</h2>
                <table class="matrix-table">
                    <thead>
                        <tr>
                            <th>Scope (linked suite spec, DS ID)</th>
                            <th>Requirements Covered (URS / FS / NFS)</th>
                            <th>Profile</th>
                            <th>Test Status</th>
                        </tr>
                    </thead>
                    <tbody id="tests-table-body">
                        <!-- Populated by JavaScript -->
                    </tbody>
                </table>
            </div>

            <div class="matrix-section">
                <h2>Traceability Summary</h2>
                <p><strong>Requirement Specifications:</strong> URS-001 to URS-021, FS-01 to FS-14, NFS-001 to NFS-023 (consolidated).</p>
                <p><strong>Design Specifications:</strong> All engine, data, theory and test DS documents in <code>docs/specs/**</code> are enumerated above with their URS/FS/NFS coverage.</p>
                <p><strong>Test Coverage:</strong> Every major capability (geometry, ingestion, retrieval, theory layering, Sys2DSL, validation, bias/temporal reasoning, persistence) has at least one dedicated suite.</p>
                <p><strong>MLP Status:</strong> Core MLP behaviour is implemented and exercised end-to-end; gaps are called out as partial coverage in the tables.</p>
            </div>

            <!-- GAMP Categories Mapping -->
            <div class="matrix-section">
                <h2>GAMP Category Mapping</h2>
                <table class="matrix-table">
                    <thead>
                        <tr>
                            <th>GAMP Category</th>
                            <th>Scope</th>
                            <th>Requirements Focus (URS / FS / NFS)</th>
                            <th>Validation Approach</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="gamp-category">
                            <td>Infrastructure Software</td>
                            <td>Core math and storage primitives</td>
                            <td>FS-01 (concept representation), FS-10 (persistence); NFS-001-002 (performance), NFS-020-023 (constraints).</td>
                            <td>Unit tests, performance checks, determinism validation (core_math, config_profiles, persistence_file_binary).</td>
                        </tr>
                        <tr class="gamp-category">
                            <td>Configurable Software</td>
                            <td>Knowledge, theories and reasoning behaviour</td>
                            <td>URS-011-015 (user-facing reasoning); FS-02, FS-04, FS-05, FS-12-14; NFS-003-008 (determinism, explainability).</td>
                            <td>Integration tests and domain suites (reason_smoke, counterfactual_layering, health_compliance, validation_engine).</td>
                        </tr>
                        <tr class="gamp-category">
                            <td>Custom Application</td>
                            <td>Interfaces, ingestion and session APIs</td>
                            <td>URS-008-010 (user types); FS-03, FS-08-09; NFS-018-019 (compatibility).</td>
                            <td>API-level and end-to-end tests (agentic_session_api, translator_bridge_normalization, sys2dsl_core).</td>
                        </tr>
                        <tr class="gamp-category">
                            <td>Support Components</td>
                            <td>Audit, bias control and governance</td>
                            <td>FS-07, FS-12; NFS-007-010 (explainability, security); URS-017-021 (constraints).</td>
                            <td>Bias and audit suites (bias_audit, relations_bootstrap, dimensions_catalog, validation_engine).</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // =============================================================================
        // Test Results Loader
        // =============================================================================

        const TEST_RESULTS_PATH = new URL('../../tests/results/test_results.json', window.location.href).href;
        // Embedded fallback (keep in sync with tests/results/test_results.json when committing)
        const EMBEDDED_RESULTS = {"timestamp":"2024-05-01T00:00:00.000Z","profile":"auto_test","summary":{"total":32,"passed":32,"failed":0,"skipped":0,"timeout":0},"suites":{"abductive_causal":{"status":"passed","passed":1,"failed":0,"total":1},"abductive_geometric":{"status":"passed","passed":1,"failed":0,"total":1},"agentic_session_api":{"status":"passed","passed":1,"failed":0,"total":1},"analogical_reasoning":{"status":"passed","passed":1,"failed":0,"total":1},"bias_control":{"status":"passed","passed":1,"failed":0,"total":1},"bounded_diamond":{"status":"passed","passed":1,"failed":0,"total":1},"cli_integration":{"status":"passed","passed":19,"failed":0,"total":19},"concept_store":{"status":"passed","passed":1,"failed":0,"total":1},"config_profiles":{"status":"passed","passed":1,"failed":0,"total":1},"contradiction_detector":{"status":"passed","passed":1,"failed":0,"total":1},"core_math":{"status":"passed","passed":1,"failed":0,"total":1},"counterfactual_layering":{"status":"passed","passed":1,"failed":0,"total":1},"dimensions_catalog":{"status":"passed","passed":1,"failed":0,"total":1},"forgetting":{"status":"passed","passed":11,"failed":0,"total":11},"health_compliance":{"status":"passed","passed":1,"failed":0,"total":1},"inference_engine":{"status":"passed","passed":1,"failed":0,"total":1},"narrative_consistency":{"status":"passed","passed":1,"failed":0,"total":1},"phase2_integration":{"status":"passed","passed":1,"failed":0,"total":1},"phase3_benchmarks":{"status":"passed","passed":1,"failed":0,"total":1},"phase3_edge_cases":{"status":"passed","passed":29,"failed":0,"total":29},"property_mapping":{"status":"passed","passed":1,"failed":0,"total":1},"reason_smoke":{"status":"passed","passed":1,"failed":0,"total":1},"reasoner_timeout":{"status":"passed","passed":1,"failed":0,"total":1},"relation_permuter":{"status":"passed","passed":1,"failed":0,"total":1},"storage_adapter":{"status":"passed","passed":1,"failed":0,"total":1},"sys2dsl_commands":{"status":"passed","passed":20,"failed":0,"total":20},"sys2dsl_core":{"status":"passed","passed":1,"failed":0,"total":1},"temporal_memory":{"status":"passed","passed":1,"failed":0,"total":1},"theory_layering":{"status":"passed","passed":12,"failed":0,"total":12},"translator_bridge_normalization":{"status":"passed","passed":1,"failed":0,"total":1},"usage_tracking":{"status":"passed","passed":11,"failed":0,"total":11},"vector_space":{"status":"passed","passed":1,"failed":0,"total":1}}};

        // Global test results cache
        let testResults = null;

        // =============================================================================
        // Data Definitions - CONSOLIDATED IDs
        // =============================================================================

        const URS_DATA = [
            { id: 'URS-001', section: 'Overview', title: 'Deterministic, explainable neuro-symbolic assistant' },
            { id: 'URS-002', section: 'Overview', title: 'Conceptual space with bounded diamonds (>=512 dims)' },
            { id: 'URS-003', section: 'Overview', title: 'System 2 reasoning with meta-rationality and layered theories' },
            { id: 'URS-004', section: 'Goals', title: 'Reproducible answers with provenance trail' },
            { id: 'URS-005', section: 'Goals', title: 'Teaching-by-mentoring via Sys2DSL with immediate effect' },
            { id: 'URS-006', section: 'Goals', title: 'What-if exploration with temporary theories' },
            { id: 'URS-007', section: 'Goals', title: 'CPU-only operation with millions of concepts at interactive latency' },
            { id: 'URS-008', section: 'Users', title: 'Domain experts externalize knowledge without coding' },
            { id: 'URS-009', section: 'Users', title: 'Operators/analysts query for determinations and audits' },
            { id: 'URS-010', section: 'Users', title: 'Integrators embed with deterministic API behavior' },
            { id: 'URS-011', section: 'Capabilities', title: 'Sys2DSL-based ingestion (NL translated externally)' },
            { id: 'URS-012', section: 'Capabilities', title: 'Query answering with context selection and justification' },
            { id: 'URS-013', section: 'Capabilities', title: 'Narrative consultation with confidence bands' },
            { id: 'URS-014', section: 'Capabilities', title: 'Layered theories with conflict signaling' },
            { id: 'URS-015', section: 'Capabilities', title: 'Geometric reasoning modes (deductive, abductive, etc.)' },
            { id: 'URS-016', section: 'Capabilities', title: 'English primary; other languages via external bridge' },
            { id: 'URS-017', section: 'Constraints', title: 'Determinism: identical inputs yield identical outputs' },
            { id: 'URS-018', section: 'Constraints', title: 'Explanations cite theory layers and dimensions' },
            { id: 'URS-019', section: 'Constraints', title: 'Knowledge stored as geometric constructs' },
            { id: 'URS-020', section: 'Constraints', title: 'Theory data persisted separately from runtime' },
            { id: 'URS-021', section: 'Success', title: 'Refuse answers when contradictions block conclusions' }
        ];

        const FS_DATA = [
            { id: 'FS-01', summary: 'Concept representation: bounded diamonds, masks, dimension partitions.' },
            { id: 'FS-02', summary: 'Theory layering, what-if reasoning, and meta-rational stack management.' },
            { id: 'FS-03', summary: 'Ingestion pipeline: Sys2DSL to encoded concepts.' },
            { id: 'FS-04', summary: 'Learning via clustering and superposition.' },
            { id: 'FS-05', summary: 'Reasoning engine: truth bands, adversarial validation.' },
            { id: 'FS-06', summary: 'Retrieval and decoding with LSH.' },
            { id: 'FS-07', summary: 'Provenance and explainability for all answers.' },
            { id: 'FS-08', summary: 'Session-based interaction via AgentSystem2/System2Session.' },
            { id: 'FS-09', summary: 'Language handling: NL translated to Sys2DSL externally.' },
            { id: 'FS-10', summary: 'Persistence, versioning, and audit logging.' },
            { id: 'FS-11', summary: 'Administrative operations and inspection.' },
            { id: 'FS-12', summary: 'Safety and bias controls via masks.' },
            { id: 'FS-13', summary: 'Validation and abstract interpretation.' },
            { id: 'FS-14', summary: 'Sys2DSL theory programs as first-class artefacts.' }
        ];

        const NFS_DATA = [
            { id: 'NFS-001', section: 'Performance', title: 'CPU-only, <500ms latency, JIT/SIMD-friendly, performant geometry' },
            { id: 'NFS-002', section: 'Performance', title: 'Millions of concepts with O(1) retrieval' },
            { id: 'NFS-003', section: 'Reliability', title: 'Deterministic execution with logged meta-rational selection' },
            { id: 'NFS-004', section: 'Reliability', title: 'Fail closed on contradictions' },
            { id: 'NFS-005', section: 'Reliability', title: 'Versioned snapshots and recovery' },
            { id: 'NFS-006', section: 'Reliability', title: 'Side-effect free validation runs' },
            { id: 'NFS-007', section: 'Auditability', title: 'Provenance on every output with append-only audit logs' },
            { id: 'NFS-008', section: 'Auditability', title: 'Toggleable bias/audit modes' },
            { id: 'NFS-009', section: 'Security', title: 'Isolated theory storage with integrity checks' },
            { id: 'NFS-010', section: 'Security', title: 'Tamper-resistant logs and access controls' },
            { id: 'NFS-011', section: 'Maintainability', title: 'Modular Node.js classes' },
            { id: 'NFS-012', section: 'Maintainability', title: 'Deterministic relation/permutation generation' },
            { id: 'NFS-013', section: 'Maintainability', title: 'Externalized configuration' },
            { id: 'NFS-014', section: 'MLP', title: 'All core capabilities present and usable' },
            { id: 'NFS-015', section: 'MLP', title: 'Correctness over micro-optimizations' },
            { id: 'NFS-016', section: 'MLP', title: 'No partial/stubbed implementations' },
            { id: 'NFS-017', section: 'MLP', title: 'End-to-end test coverage' },
            { id: 'NFS-018', section: 'Compatibility', title: 'English core; translation bridge boundary' },
            { id: 'NFS-019', section: 'Compatibility', title: 'Stable, schema-validated APIs' },
            { id: 'NFS-020', section: 'Limits', title: 'Dimensions: {512, 1024, 2048, 4096}' },
            { id: 'NFS-021', section: 'Limits', title: 'Values: [-127, 127] with clamping' },
            { id: 'NFS-022', section: 'Limits', title: 'Configurable recursion horizon' },
            { id: 'NFS-023', section: 'Limits', title: 'Bounded reasoning iterations' }
        ];

        const DS_DATA = [
            // Core geometry and math
            { spec: 'core/vector_space.js.md', name: 'VectorSpace: high-dimensional buffers and arithmetic.', dsId: 'DS[/core/vector_space.js]', reqs: 'FS-01, FS-06; NFS-001', coverage: 'full', testSuite: 'core_math' },
            { spec: 'core/bounded_diamond.js.md', name: 'BoundedDiamond: hyper-rectangles + L1 ball + masks.', dsId: 'DS[/core/bounded_diamond.js]', reqs: 'FS-01, FS-04, FS-05; NFS-001', coverage: 'full', testSuite: 'core_math' },
            { spec: 'core/math_engine.js.md', name: 'MathEngine: stateless vector ops and distances.', dsId: 'DS[/core/math_engine.js]', reqs: 'FS-01, FS-05, FS-06; NFS-001', coverage: 'full', testSuite: 'core_math' },
            { spec: 'core/relation_permuter.js.md', name: 'RelationPermuter: deterministic permutations and inverses.', dsId: 'DS[/core/relation_permuter.js]', reqs: 'FS-01, FS-03, FS-05, FS-06; NFS-012', coverage: 'full', testSuite: 'relation_permuter' },

            // Knowledge and theories
            { spec: 'knowledge/concept_store.js.md', name: 'ConceptStore: persistence of concepts and clusters.', dsId: 'DS[/knowledge/concept_store.js]', reqs: 'FS-01, FS-03, FS-04, FS-06, FS-10; NFS-002', coverage: 'full', testSuite: 'concept_store' },
            { spec: 'knowledge/theory_layer.js.md', name: 'TheoryLayer: overlays for bounds/radii/masks.', dsId: 'DS[/knowledge/theory_layer.js]', reqs: 'FS-02, FS-05, FS-12, FS-13; NFS-003', coverage: 'full', testSuite: 'counterfactual_layering' },
            { spec: 'knowledge/theory_stack.js.md', name: 'TheoryStack: layered theories and meta-rational selection.', dsId: 'DS[/knowledge/theory_stack.js]', reqs: 'FS-02, FS-05, FS-13; NFS-003', coverage: 'full', testSuite: 'counterfactual_layering' },
            { spec: 'knowledge/base_theories.md', name: 'Base theory catalogue and defaults.', dsId: 'DS[/knowledge/base_theories]', reqs: 'FS-02, FS-10, FS-14; NFS-005', coverage: 'partial', testSuite: null },
            { spec: 'knowledge/default_relations.md', name: 'Default relation set and characteristics.', dsId: 'DS[/knowledge/default_relations]', reqs: 'FS-01, FS-03, FS-05, FS-06; NFS-012', coverage: 'full', testSuite: 'relation_permuter' },
            { spec: 'knowledge/dimensions.md', name: 'Ontology/axiology dimension catalogue.', dsId: 'DS[/knowledge/dimensions]', reqs: 'FS-01, FS-12; NFS-020', coverage: 'full', testSuite: 'dimensions_catalog' },
            { spec: 'knowledge/usage_tracking.md', name: 'Usage tracking and prioritization counters.', dsId: 'DS[/knowledge/usage_tracking]', reqs: 'FS-04, FS-10; NFS-002', coverage: 'full', testSuite: 'usage_tracking', isNew: true },
            { spec: 'knowledge/forgetting.md', name: 'Forgetting mechanisms and threshold-based removal.', dsId: 'DS[/knowledge/forgetting]', reqs: 'FS-04, FS-10; NFS-002', coverage: 'full', testSuite: 'forgetting', isNew: true },

            // Ingestion and learning
            { spec: 'ingest/parser.js.md', name: 'NLParser: parse Sys2DSL into S-R-O trees.', dsId: 'DS[/ingest/parser.js]', reqs: 'FS-03, FS-09; NFS-022', coverage: 'full', testSuite: 'translator_bridge_normalization' },
            { spec: 'ingest/encoder.js.md', name: 'Encoder: assemble vectors and update concepts.', dsId: 'DS[/ingest/encoder.js]', reqs: 'FS-01, FS-03, FS-04; NFS-001', coverage: 'full', testSuite: 'reason_smoke' },
            { spec: 'ingest/clustering.js.md', name: 'ClusterManager: split/merge diamonds for polysemy.', dsId: 'DS[/ingest/clustering.js]', reqs: 'FS-04, FS-05; NFS-002', coverage: 'full', testSuite: 'reason_smoke' },

            // Reasoning and retrieval
            { spec: 'reason/reasoner.js.md', name: 'Reasoner: assemble runtime concepts and answer queries.', dsId: 'DS[/reason/reasoner.js]', reqs: 'FS-02, FS-05, FS-12, FS-13; NFS-003', coverage: 'full', testSuite: 'reason_smoke' },
            { spec: 'reason/retrieval.js.md', name: 'Retriever: blind decoding and nearest-neighbour search.', dsId: 'DS[/reason/retrieval.js]', reqs: 'FS-05, FS-06; NFS-002', coverage: 'full', testSuite: 'reason_smoke' },
            { spec: 'reason/bias_control.js.md', name: 'BiasController: masks and bias/audit modes.', dsId: 'DS[/reason/bias_control.js]', reqs: 'FS-05, FS-12; NFS-008', coverage: 'full', testSuite: 'bias_control' },
            { spec: 'reason/validation.js.md', name: 'ValidationEngine: symbolic/abstract interpretation.', dsId: 'DS[/reason/validation.js]', reqs: 'FS-05, FS-12, FS-13; NFS-006', coverage: 'full', testSuite: 'counterfactual_layering' },
            { spec: 'reason/temporal_memory.js.md', name: 'TemporalMemory: temporal/causal reasoning.', dsId: 'DS[/reason/temporal_memory.js]', reqs: 'FS-05; NFS-023', coverage: 'partial', testSuite: 'narrative_consistency' },

            // Sys2DSL and theory engine
            { spec: 'theory/dsl_engine.js.md', name: 'TheoryDSLEngine: Sys2DSL interpreter and topological eval.', dsId: 'DS[/theory/dsl_engine.js]', reqs: 'FS-08, FS-12, FS-13, FS-14; NFS-003', coverage: 'full', testSuite: 'sys2dsl_core' },
            { spec: 'theory/Sys2DSL_syntax.md', name: 'Sys2DSL complete language specification.', dsId: 'DS[/theory/Sys2DSL_syntax]', reqs: 'FS-08, FS-14; NFS-003', coverage: 'full', testSuite: 'sys2dsl_syntax', isNew: true },
            { spec: 'theory/Sys2DSL_commands.md', name: 'Sys2DSL full command reference (40+ commands).', dsId: 'DS[/theory/Sys2DSL_commands]', reqs: 'FS-08, FS-14; NFS-003', coverage: 'full', testSuite: 'sys2dsl_commands', isNew: true },
            { spec: 'theory/Sys2DSL_arch.md', name: 'Sys2DSL architecture and semantics.', dsId: 'DS[/theory/Sys2DSL_arch]', reqs: 'FS-08, FS-14; NFS-003', coverage: 'full', testSuite: 'sys2dsl_core' },
            { spec: 'theory/topological_eval.md', name: 'Topological evaluation of Sys2DSL scripts.', dsId: 'DS[/theory/topological_eval]', reqs: 'FS-13, FS-14; NFS-003', coverage: 'full', testSuite: 'sys2dsl_core' },

            // Interface and orchestration
            { spec: 'interface/translator_bridge.js.md', name: 'TranslatorBridge: external LLM/translation boundary.', dsId: 'DS[/interface/translator_bridge.js]', reqs: 'FS-03, FS-08, FS-09; NFS-018', coverage: 'full', testSuite: 'translator_bridge_normalization' },
            { spec: 'interface/api.js.md', name: 'EngineAPI: internal facade for engine modules.', dsId: 'DS[/interface/api.js]', reqs: 'FS-03, FS-05, FS-08, FS-13; NFS-019', coverage: 'full', testSuite: 'agentic_session_api' },
            { spec: 'interface/agent_system2.js.md', name: 'AgentSystem2: top-level entry and configuration owner.', dsId: 'DS[/interface/agent_system2.js]', reqs: 'FS-08; NFS-011', coverage: 'full', testSuite: 'agentic_session_api' },
            { spec: 'interface/system2_session.js.md', name: 'System2Session: session facade and Sys2DSL host.', dsId: 'DS[/interface/system2_session.js]', reqs: 'FS-08, FS-14; NFS-011', coverage: 'full', testSuite: 'agentic_session_api' },
            { spec: 'interface/usecase_define_theory.md', name: 'Use Case: Defining Theories.', dsId: 'DS[/interface/usecase_define_theory]', reqs: 'FS-02, FS-10, FS-14; NFS-005', coverage: 'full', testSuite: 'usecase_integration', isNew: true },
            { spec: 'interface/usecase_validate.md', name: 'Use Case: Validating Consistency.', dsId: 'DS[/interface/usecase_validate]', reqs: 'FS-05, FS-13; NFS-006', coverage: 'full', testSuite: 'usecase_integration', isNew: true },
            { spec: 'interface/usecase_hypothesize.md', name: 'Use Case: Generating Hypotheses (abduction).', dsId: 'DS[/interface/usecase_hypothesize]', reqs: 'FS-05, FS-06; NFS-003', coverage: 'full', testSuite: 'usecase_integration', isNew: true },
            { spec: 'interface/usecase_prove.md', name: 'Use Case: Proving Theorems (deduction).', dsId: 'DS[/interface/usecase_prove]', reqs: 'FS-05, FS-13; NFS-006', coverage: 'full', testSuite: 'usecase_integration', isNew: true },
            { spec: 'cli/agisystem2-cli.js.md', name: 'AGISystem2 Raw CLI entrypoint.', dsId: 'DS[/cli/agisystem2-cli.js]', reqs: 'FS-08, FS-09, FS-11; NFS-018', coverage: 'partial', testSuite: 'cli_integration', isNew: true },

            // Chat interface
            { spec: 'chat/chat_engine.mjs.md', name: 'ChatEngine: LLM-backed natural language interface.', dsId: 'DS[/chat/chat_engine.mjs]', reqs: 'FS-08, FS-09, FS-11; NFS-018', coverage: 'partial', testSuite: 'chat_interface', isNew: true },
            { spec: 'chat/chat_repl.mjs.md', name: 'ChatREPL: interactive shell for chat.', dsId: 'DS[/chat/chat_repl.mjs]', reqs: 'FS-08, FS-11; NFS-018', coverage: 'partial', testSuite: 'chat_interface', isNew: true },
            { spec: 'chat/chat_handlers.mjs.md', name: 'ChatHandlers facade: route intents to teach/ask/import/list.', dsId: 'DS[/chat/chat_handlers.mjs]', reqs: 'FS-08, FS-09; NFS-018', coverage: 'partial', testSuite: 'chat_interface', isNew: true },
            { spec: 'chat/handler_utils.mjs.md', name: 'Chat handler utilities: deterministic parsing and inference.', dsId: 'DS[/chat/handler_utils.mjs]', reqs: 'FS-03, FS-09; NFS-022', coverage: 'partial', testSuite: 'chat_interface', isNew: true },
            { spec: 'chat/handlers_teach.mjs.md', name: 'Teaching and contradiction handlers for chat.', dsId: 'DS[/chat/handlers_teach.mjs]', reqs: 'FS-03, FS-05; NFS-006', coverage: 'partial', testSuite: 'chat_interface', isNew: true },
            { spec: 'chat/handlers_ask.mjs.md', name: 'Question answering handlers for chat.', dsId: 'DS[/chat/handlers_ask.mjs]', reqs: 'FS-05, FS-06; NFS-003', coverage: 'partial', testSuite: 'chat_interface', isNew: true },
            { spec: 'chat/handlers_theory.mjs.md', name: 'Theory management and import handlers for chat.', dsId: 'DS[/chat/handlers_theory.mjs]', reqs: 'FS-02, FS-10; NFS-013', coverage: 'partial', testSuite: 'chat_interface', isNew: true },

            // Support and storage
            { spec: 'support/config.js.md', name: 'Config: profiles, dimension and recursion limits.', dsId: 'DS[/support/config.js]', reqs: 'FS-01, FS-10, FS-12; NFS-013', coverage: 'full', testSuite: 'config_profiles' },
            { spec: 'support/storage.js.md', name: 'StorageAdapter: binary/text persistence.', dsId: 'DS[/support/storage.js]', reqs: 'FS-01, FS-06, FS-10; NFS-009', coverage: 'full', testSuite: 'storage_adapter' },
            { spec: 'support/audit_log.js.md', name: 'AuditLog: append-only audit trail.', dsId: 'DS[/support/audit_log.js]', reqs: 'FS-07, FS-10, FS-12; NFS-007', coverage: 'full', testSuite: 'storage_adapter' },

            // Init / data specs
            { spec: 'init/bootstrap.md', name: 'Bootstrap: data and configuration boot sequence.', dsId: 'DS[/init/bootstrap]', reqs: 'FS-01, FS-03, FS-10; NFS-013', coverage: 'partial', testSuite: 'config_profiles' },
            { spec: 'init/config_profile.json.md', name: 'Config profile JSON schema.', dsId: 'DS[/init/config_profile.json]', reqs: 'FS-01, FS-10; NFS-013', coverage: 'partial', testSuite: 'config_profiles' },
            { spec: 'init/dimensions.json.md', name: 'Dimension catalogue JSON schema.', dsId: 'DS[/init/dimensions.json]', reqs: 'FS-01, FS-12; NFS-020', coverage: 'partial', testSuite: 'dimensions_catalog' },
            { spec: 'init/relations.json.md', name: 'Relations catalogue JSON schema.', dsId: 'DS[/init/relations.json]', reqs: 'FS-01, FS-03, FS-05, FS-06; NFS-012', coverage: 'partial', testSuite: 'relation_permuter' },

            // Interface - CLI
            { spec: 'interface/cli.md', name: 'CLI: interactive REPL and batch mode.', dsId: 'DS[/interface/cli]', reqs: 'FS-08, FS-11, FS-14; NFS-011, NFS-019', coverage: 'full', testSuite: 'cli_integration', isNew: true },

            // Spec playbook and DS map
            { spec: 'agent.md', name: 'Specification playbook and conventions.', dsId: 'DS[/agent]', reqs: 'FS-10; NFS-013', coverage: 'partial', testSuite: null },
            { spec: 'DS_map.md', name: 'Design Specification Map (DS_map).', dsId: 'DS-MAP-001', reqs: 'FS-10; NFS-013', coverage: 'partial', testSuite: null }
        ];

        const TEST_SUITES = [
            { spec: 'tests/core_math/runSuite.md', name: 'MathEngine and VectorSpace core arithmetic.', dsId: 'DS[/tests/core_math/runSuite]', reqs: 'FS-01, FS-05; NFS-001', profile: 'auto_test', suiteId: 'core_math' },
            { spec: 'tests/relation_permuter/runSuite.md', name: 'RelationPermuter and default relations.', dsId: 'DS[/tests/relation_permuter/runSuite]', reqs: 'FS-01, FS-03, FS-05, FS-06; NFS-012', profile: 'auto_test', suiteId: 'relation_permuter' },
            { spec: 'tests/config_profiles/runSuite.md', name: 'Configuration profiles for auto/manual/prod.', dsId: 'DS[/tests/config_profiles/runSuite]', reqs: 'FS-01, FS-10, FS-12; NFS-013', profile: 'auto_test + manual_test + prod', suiteId: 'config_profiles' },
            { spec: 'tests/dimensions_catalog/runSuite.md', name: 'Dimension catalogue and partitions.', dsId: 'DS[/tests/dimensions_catalog/runSuite]', reqs: 'FS-01, FS-12; NFS-020', profile: 'auto_test', suiteId: 'dimensions_catalog' },
            { spec: 'tests/agentic_session_api/runSuite.md', name: 'AgentSystem2/System2Session Sys2DSL interaction.', dsId: 'DS[/tests/agentic_session_api/runSuite]', reqs: 'FS-08, FS-14; NFS-011', profile: 'auto_test', suiteId: 'agentic_session_api' },
            { spec: 'tests/sys2dsl_core/runSuite.md', name: 'Core Sys2DSL engine and topological evaluation.', dsId: 'DS[/tests/sys2dsl_core/runSuite]', reqs: 'FS-08, FS-12, FS-13, FS-14; NFS-003', profile: 'auto_test', suiteId: 'sys2dsl_core' },
            { spec: 'tests/reason_smoke/runSuite.md', name: 'End-to-end ingest and basic reasoning.', dsId: 'DS[/tests/reason_smoke/runSuite]', reqs: 'FS-03, FS-05, FS-07, FS-08; NFS-003', profile: 'auto_test', suiteId: 'reason_smoke' },
            { spec: 'tests/abductive_causal/runSuite.md', name: 'Abductive reasoning for CAUSES/CAUSED_BY.', dsId: 'DS[/tests/abductive_causal/runSuite]', reqs: 'FS-05, FS-06; NFS-003', profile: 'auto_test', suiteId: 'abductive_causal' },
            { spec: 'tests/abductive_geometric/runSuite.md', name: 'Abductive geometric reasoning tests.', dsId: 'DS[/tests/abductive_geometric/runSuite]', reqs: 'FS-05, FS-06; NFS-003', profile: 'auto_test', suiteId: 'abductive_geometric' },
            { spec: 'tests/analogical_reasoning/runSuite.md', name: 'Analogical vector delta reasoning.', dsId: 'DS[/tests/analogical_reasoning/runSuite]', reqs: 'FS-05, FS-06; NFS-003', profile: 'manual_test', suiteId: 'analogical_reasoning' },
            { spec: 'tests/counterfactual_layering/runSuite.md', name: 'Counterfactuals, theory layering and validation.', dsId: 'DS[/tests/counterfactual_layering/runSuite]', reqs: 'FS-02, FS-05, FS-13; NFS-003', profile: 'auto_test', suiteId: 'counterfactual_layering' },
            { spec: 'tests/bias_control/runSuite.md', name: 'Bias masks and veil-of-ignorance checks.', dsId: 'DS[/tests/bias_control/runSuite]', reqs: 'FS-05, FS-12; NFS-008', profile: 'auto_test', suiteId: 'bias_control' },
            { spec: 'tests/bounded_diamond/runSuite.md', name: 'BoundedDiamond geometry tests.', dsId: 'DS[/tests/bounded_diamond/runSuite]', reqs: 'FS-01, FS-04; NFS-001', profile: 'auto_test', suiteId: 'bounded_diamond' },
            { spec: 'tests/concept_store/runSuite.md', name: 'ConceptStore persistence tests.', dsId: 'DS[/tests/concept_store/runSuite]', reqs: 'FS-01, FS-06, FS-10; NFS-002', profile: 'auto_test', suiteId: 'concept_store' },
            { spec: 'tests/health_compliance/runSuite.md', name: 'Health procedure compliance via Sys2DSL programmes.', dsId: 'DS[/tests/health_compliance/runSuite]', reqs: 'FS-05, FS-14; NFS-003', profile: 'auto_test', suiteId: 'health_compliance' },
            { spec: 'tests/narrative_consistency/runSuite.md', name: 'Narrative consistency and temporal reasoning.', dsId: 'DS[/tests/narrative_consistency/runSuite]', reqs: 'FS-05; NFS-023', profile: 'auto_test', suiteId: 'narrative_consistency' },
            { spec: 'tests/property_mapping/runSuite.md', name: 'Property mapping tests.', dsId: 'DS[/tests/property_mapping/runSuite]', reqs: 'FS-01, FS-03; NFS-012', profile: 'auto_test', suiteId: 'property_mapping' },
            { spec: 'tests/reasoner_timeout/runSuite.md', name: 'Reasoner timeout and bounds tests.', dsId: 'DS[/tests/reasoner_timeout/runSuite]', reqs: 'FS-05; NFS-023', profile: 'auto_test', suiteId: 'reasoner_timeout' },
            { spec: 'tests/storage_adapter/runSuite.md', name: 'StorageAdapter persistence tests.', dsId: 'DS[/tests/storage_adapter/runSuite]', reqs: 'FS-10; NFS-009', profile: 'auto_test', suiteId: 'storage_adapter' },
            { spec: 'tests/temporal_memory/runSuite.md', name: 'TemporalMemory and causal reasoning tests.', dsId: 'DS[/tests/temporal_memory/runSuite]', reqs: 'FS-05; NFS-023', profile: 'auto_test', suiteId: 'temporal_memory' },
            { spec: 'tests/translator_bridge_normalization/runSuite.md', name: 'TranslatorBridge + Parser normalization.', dsId: 'DS[/tests/translator_bridge_normalization/runSuite]', reqs: 'FS-03, FS-08, FS-09; NFS-018', profile: 'auto_test', suiteId: 'translator_bridge_normalization' },
            { spec: 'tests/vector_space/runSuite.md', name: 'VectorSpace operations tests.', dsId: 'DS[/tests/vector_space/runSuite]', reqs: 'FS-01; NFS-001', profile: 'auto_test', suiteId: 'vector_space' },
            { spec: 'tests/runTests.js.md', name: 'Test harness orchestration.', dsId: 'DS[/tests/runTests.js]', reqs: 'FS-10, FS-13; NFS-017', profile: 'all profiles', suiteId: 'runTests' },
            // NEW: Sys2DSL and Memory Management tests
            { spec: 'tests/sys2dsl_syntax/runSuite.md', name: 'Sys2DSL lexical structure and parsing.', dsId: 'DS[/tests/sys2dsl_syntax/runSuite]', reqs: 'FS-08, FS-14; NFS-003', profile: 'auto_test', suiteId: 'sys2dsl_syntax', isNew: true },
            { spec: 'tests/sys2dsl_commands/runSuite.md', name: 'Sys2DSL command categories (40+ commands).', dsId: 'DS[/tests/sys2dsl_commands/runSuite]', reqs: 'FS-08, FS-14; NFS-003', profile: 'auto_test', suiteId: 'sys2dsl_commands', isNew: true },
            { spec: 'tests/usage_tracking/runSuite.md', name: 'Usage counters, timestamps, and priority scoring.', dsId: 'DS[/tests/usage_tracking/runSuite]', reqs: 'FS-04, FS-10; NFS-002', profile: 'auto_test', suiteId: 'usage_tracking', isNew: true },
            { spec: 'tests/forgetting/runSuite.md', name: 'Threshold-based forgetting and protection.', dsId: 'DS[/tests/forgetting/runSuite]', reqs: 'FS-04, FS-10; NFS-002', profile: 'auto_test', suiteId: 'forgetting', isNew: true },
            { spec: 'tests/usecase_integration/runSuite.md', name: 'High-level use cases: theory definition, validation, abduction, proof.', dsId: 'DS[/tests/usecase_integration/runSuite]', reqs: 'FS-02, FS-05, FS-13, FS-14; NFS-003, NFS-014', profile: 'auto_test + manual_test', suiteId: 'usecase_integration', isNew: true },
            // CLI Integration
            { spec: 'tests/cli_integration/runSuite.md', name: 'CLI batch mode, commands, JSON output.', dsId: 'DS[/tests/cli_integration/runSuite]', reqs: 'FS-08, FS-11, FS-14; NFS-011, NFS-019', profile: 'auto_test', suiteId: 'cli_integration', isNew: true }
        ];

        // =============================================================================
        // Helper Functions
        // =============================================================================

        function getTestStatus(suiteId) {
            if (!testResults || !testResults.suites) {
                return { status: 'unknown', label: 'UNKNOWN', details: '' };
            }

            const suite = testResults.suites[suiteId];
            if (!suite) {
                return { status: 'unknown', label: 'UNKNOWN', details: '' };
            }

            // Handle new format with status field
            if (suite.status === 'skipped') {
                return { status: 'skipped', label: 'SKIPPED', details: suite.reason || '' };
            }

            if (suite.status === 'passed') {
                return { status: 'passed', label: 'PASSED', details: suite.total ? `${suite.passed}/${suite.total}` : '' };
            }

            if (suite.status === 'failed') {
                if (suite.passed > 0) {
                    return { status: 'partial', label: 'PARTIAL', details: `${suite.passed}/${suite.total} passed` };
                }
                return { status: 'failed', label: 'FAILED', details: suite.total ? `${suite.failed}/${suite.total} failed` : '' };
            }

            if (suite.status === 'timeout') {
                return { status: 'failed', label: 'TIMEOUT', details: 'Test timed out' };
            }

            // Fallback for old format (skipped as boolean)
            if (suite.skipped === true) {
                return { status: 'skipped', label: 'SKIPPED', details: suite.reason || '' };
            }

            if (suite.passed === suite.total && suite.total > 0) {
                return { status: 'passed', label: 'PASSED', details: `${suite.passed}/${suite.total}` };
            }

            if (suite.failed > 0) {
                if (suite.passed > 0) {
                    return { status: 'partial', label: 'PARTIAL', details: `${suite.passed}/${suite.total} passed` };
                }
                return { status: 'failed', label: 'FAILED', details: `${suite.failed}/${suite.total} failed` };
            }

            return { status: 'unknown', label: 'UNKNOWN', details: '' };
        }

        function createStatusBadge(statusObj) {
            const badge = document.createElement('span');
            badge.className = `test-status status-${statusObj.status}`;
            badge.textContent = statusObj.label;
            badge.title = statusObj.details;
            return badge;
        }

        // =============================================================================
        // Table Rendering
        // =============================================================================

        function renderURSTable() {
            const tbody = document.getElementById('urs-table-body');
            tbody.innerHTML = '';

            for (const urs of URS_DATA) {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>
                        <span class="spec-id">${urs.id}</span><br>
                        <a href="../specsLoader.html?spec=URS.md#${urs.id}" class="spec-link">${urs.section} - ${urs.id}</a>
                    </td>
                    <td>${urs.title}</td>
                `;
                tbody.appendChild(tr);
            }
        }

        function renderFSTable() {
            const tbody = document.getElementById('fs-table-body');
            tbody.innerHTML = '';

            for (const fs of FS_DATA) {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>
                        <span class="spec-id">${fs.id}</span><br>
                        <a href="../specsLoader.html?spec=FS.md#${fs.id}" class="spec-link">${fs.id} in FS.md</a>
                    </td>
                    <td>${fs.summary}</td>
                `;
                tbody.appendChild(tr);
            }
        }

        function renderNFSTable() {
            const tbody = document.getElementById('nfs-table-body');
            tbody.innerHTML = '';

            for (const nfs of NFS_DATA) {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>
                        <span class="spec-id">${nfs.id}</span><br>
                        <a href="../specsLoader.html?spec=NFS.md#${nfs.id}" class="spec-link">${nfs.section} - ${nfs.id}</a>
                    </td>
                    <td>${nfs.title}</td>
                `;
                tbody.appendChild(tr);
            }
        }

        function renderDSTable() {
            const tbody = document.getElementById('ds-table-body');
            tbody.innerHTML = '';

            for (const ds of DS_DATA) {
                const tr = document.createElement('tr');
                if (ds.isNew) {
                    tr.className = 'new-doc';
                }

                const status = ds.testSuite ? getTestStatus(ds.testSuite) : { status: 'unknown', label: 'UNKNOWN', details: 'No test suite' };
                const newBadge = ds.isNew ? '<span class="new-badge">NEW</span>' : '';

                tr.innerHTML = `
                    <td>
                        <a href="../specsLoader.html?spec=${ds.spec}" class="spec-link">${ds.name}</a>${newBadge}<br>
                        <span class="spec-id">${ds.dsId}</span>
                    </td>
                    <td>${ds.reqs}</td>
                    <td class="coverage-${ds.coverage}">${ds.coverage === 'full' ? 'Full' : 'Partial'}</td>
                    <td></td>
                `;
                tr.lastElementChild.appendChild(createStatusBadge(status));
                tbody.appendChild(tr);
            }
        }

        function renderTestsTable() {
            const tbody = document.getElementById('tests-table-body');
            tbody.innerHTML = '';

            for (const suite of TEST_SUITES) {
                const tr = document.createElement('tr');
                if (suite.isNew) {
                    tr.className = 'new-doc';
                }
                const status = getTestStatus(suite.suiteId);
                const newBadge = suite.isNew ? '<span class="new-badge">NEW</span>' : '';

                tr.innerHTML = `
                    <td>
                        <a href="../specsLoader.html?spec=${suite.spec}" class="spec-link">${suite.name}</a>${newBadge}<br>
                        <span class="spec-id">${suite.dsId}</span>
                    </td>
                    <td>${suite.reqs}</td>
                    <td>${suite.profile}</td>
                    <td></td>
                `;
                tr.lastElementChild.appendChild(createStatusBadge(status));
                tbody.appendChild(tr);
            }
        }

        function renderSummary() {
            const container = document.getElementById('summary-stats');
            const timestampEl = document.getElementById('results-timestamp');

            if (!testResults) {
                container.innerHTML = '<span class="loading">No test results available. Run the test suite to generate results.</span>';
                timestampEl.textContent = '';
                return;
            }

            const summary = testResults.summary || {};
            const passed = summary.passed || 0;
            const failed = summary.failed || 0;
            const skipped = summary.skipped || 0;
            const total = summary.total || 0;

            container.innerHTML = `
                <div class="stat-item">
                    <span class="stat-value" style="color: #155724;">${passed}</span>
                    <span class="stat-label">Passed</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value" style="color: #721c24;">${failed}</span>
                    <span class="stat-label">Failed</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value" style="color: #004085;">${skipped}</span>
                    <span class="stat-label">Skipped</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value">${total}</span>
                    <span class="stat-label">Total Tests</span>
                </div>
            `;

            if (testResults.timestamp) {
                const date = new Date(testResults.timestamp);
                timestampEl.textContent = `Results from: ${date.toLocaleString()}`;
            }
        }

        // =============================================================================
        // Initialization
        // =============================================================================

        async function loadTestResults() {
            try {
                const response = await fetch(TEST_RESULTS_PATH, { cache: 'no-cache' });
                if (response.ok) {
                    testResults = await response.json();
                    return;
                }
                console.log('Test results file not found at path, falling back to embedded data');
            } catch (error) {
                console.log('Error loading test results, falling back to embedded data:', error);
            }
            testResults = EMBEDDED_RESULTS || null;
        }

        async function init() {
            await loadTestResults();
            renderSummary();
            renderURSTable();
            renderFSTable();
            renderNFSTable();
            renderDSTable();
            renderTestsTable();
        }

        // Run on page load
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
